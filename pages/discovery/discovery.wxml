<!--发现主页-->
<view class="discovery" style="visibility: {{canShow?'visible':'hidden'}};">
    <!-- 引导用户收藏小程序卡片 -->
    <view class="guide-collection" wx:if='{{showGuideCollection!==""}}' style="top: {{statusBarHeight + 40}}px">
        <view class="guide-collection-first" bindtap="changeGuideCollectionStatus" wx:if='{{showGuideCollection===1}}'>
            <image style="width:532rpx;height: 116rpx;" src="https://huayang-img.oss-cn-shanghai.aliyuncs.com/1631956461xLaFRy.jpg"></image>
        </view>
        <view class="guide-collection-second" bindtap="closeGuideCollection" wx:if='{{showGuideCollection===2}}'>
            <image src="https://huayang-img.oss-cn-shanghai.aliyuncs.com/1631929212wEQTSo.jpg"></image>
        </view>
    </view>

    <!-- 标题 -->
    <view class="global-title">
        <image src="https://huayang-img.oss-cn-shanghai.aliyuncs.com/1636424145SJILsd.jpg" mode="aspectFit" class="logo"></image><text>生活有花样</text>
    </view>

    <!-- banner -->
    <view wx:if="{{bannerList.length!==0}}">
        <!-- banner 滚动区域 -->
        <view class="swiper-box" id="swiper-box">
            <swiper class="swiper-item-box" bindchange="changeSwiperIndex" circular autoplay interval="{{3000}}" duration="{{500}}">
                <swiper-item wx:for="{{bannerList}}" wx:key="index" bindtap="joinCampFromBanner" data-item="{{item}}">
                    <view class="swiper-cover"></view>
                    <image mode="aspectFill" src="{{item.pic_url}}"></image>
                </swiper-item>
            </swiper>
            <view class="swiper-dot">
                <view wx:for="{{bannerList}}" wx:key="index" wx:if="{{bannerList.length>1}}" class="{{current===index?'swiper-dot-item-active swiper-dot-item':'swiper-dot-item'}}"></view>
            </view>
        </view>

        <view class="text-banner" wx:if="{{textBannerList.length > 0}}">
            <text class="text-banner-item {{index === 1 ? 'black' : ''}} limit-one-line" wx:for="{{textBannerList}}">{{item.title}}</text>
        </view>
    </view>

    <!-- 品质好物 -->
    <view class="qualities">
        <view class="quality-title"><text>品质好物</text></view>
        <view class="quality-content">
            <view class="quality-item" wx:for="{{qualityList}}" wx:key="index">
                <image class="quality-item-picture" src="{{item.cover}}" mode="aspectFit"></image>
                <text class="quality-item-text limit-one-line">{{item.title}}</text>
            </view>
        </view>
    </view>

    <!-- 最新活动 -->
    <view class="new-activity-module">
        <view class="new-activity-title">
            <view class="new-activity-title-left">
                <view class="new-activity-main-title">花样最新活动</view>
                <view class="new-activity-sub-title">过积极、健康、时尚的品质生活</view>
            </view>
            <view class="new-activity-title-right">
                <image src="https://huayang-img.oss-cn-shanghai.aliyuncs.com/1629777041DSFiML.jpg"></image>
                <text class="new-activity-title-right-one">今天</text>
                <text class="new-activity-title-right-two">{{nowDate}}</text>
            </view>
        </view>
        <view class="new-activity-main">
            <view class="new-activity-item" wx:for="{{newActivityList}}" wx:key='index'>
                <view class="new-activity-item-top">
                    <video src="{{item.video_url}}" show-center-play-btn='{{false}}' object-fit="cover" bindpause="pauseNewActivityVideo" id="new-activity-item-video-{{index}}" bindfullscreenchange='enterFullNewActivityVideo' wx:if='{{item.video_url&&newActivityVideoPlayIndex===index}}'></video>
                    <image src="{{item.cover+'?x-oss-process=style/huayang'}}" data-type='{{item.type}}' mode="widthFix" bindtap="{{item.video_url?'playNewActivityVideo':'newActivityItemTap'}}" class="new-activity-item-play-cover" data-index='{{index}}' data-item="{{item.link_url}}" data-meta='{{item}}' wx:if="{{!item.video_url||newActivityVideoPlayIndex!==index}}">
                    </image>
                    <image src="https://huayang-img.oss-cn-shanghai.aliyuncs.com/1629877073cFVNcu.jpg" data-index='{{index}}' wx:if="{{(!item.video_url||newActivityVideoPlayIndex!==index)&&item.video_url}}" class="new-activity-item-play-icon" bindtap="playNewActivityVideo">
                    </image>
                    <view class="new-activity-item-label" wx:if="{{!item.video_url||newActivityVideoPlayIndex!==index}}">
                        {{item.label}}</view>
                </view>
                <view class="new-activity-item-title" data-item="{{item.link_url}}" bindtap="newActivityItemTap" data-meta='{{item}}' data-type='{{item.type}}'>
                    {{item.title}}</view>
                <view class="new-activity-item-bottom" data-item="{{item.link_url}}" bindtap="newActivityItemTap" data-meta='{{item}}' data-type='{{item.type}}'>
                    <view class="new-activity-item-bottom-date">{{item.time}}</view>
                    <view class="new-activity-item-bottom-button">点击查看</view>
                </view>
            </view>
        </view>
    </view>

    <!-- 精品课程 -->
    <bestCourseLayout wx:if="{{courseList.length > 0}}" courseList="{{courseList}}" />

    <!-- 校友活动 -->
    <view class="college-activity" wx:if="{{activityList.length > 0}}">
        <view class="layer">校友活动</view>
        <view class="college-activity-item" wx:for="{{activityList}}" wx:key="index" data-item="{{item}}" bindtap="onCollegeActivityTap">
            <image class="college-activity-picture" mode="aspectFill" src="{{item.cover_url+'?x-oss-process=style/huayang'}}"></image>
            <view class="college-activity-title limit-two-line">{{item.title}}</view>
        </view>
    </view>

    <!-- 花样游学 -->
    <view class="travel" wx:if="{{travelList.length > 0}}">
        <view class="travel-layout">花样游学</view>
        <view class="travel-item" wx:for="{{travelList}}" wx:key="index" bindtap="onTravelTap" data-item="{{item}}">
            <swiper class="travel-cover" circular autoplay interval="{{3500 + index * 300}}" duration="{{500}}">
                <swiper-item wx:for="{{item.covers}}" wx:for-item="coverItem" wx:key="index" data-item="{{coverItem}}">
                    <image class="travel-cover" src="{{coverItem+'?x-oss-process=style/huayang'}}" mode="aspectFill"></image>
                </swiper-item>
            </swiper>
            <view class="travel-title limit-two-line">{{item.title}}</view>
            <view class="travel-info">
                <view class="travel-price">¥<text class="price-01">{{item.discount_price / 100}}</text><text wx:if="{{item.price}}" class="price-02">¥{{item.price / 100}}</text>
                </view>
                <view class="travel-visit-no">{{item.visit_count}}人看过</view>
            </view>
        </view>

        <view class="more-travel" bindtap="onMoreTravelLineTap">查看更多游学路线 ›</view>
    </view>

    <!-- 线下乐活课堂 -->
    <view class="offline-course" wx:if="{{offlineList.length > 0}}">
        <view class="layer">线下乐活课堂</view>
        <view class="offline-course-item" wx:for="{{offlineList}}" wx:key="index" data-item="{{item}}" bindtap="goToOfflineCourseDetail">
            <image class="pic" src="{{item.cover+'?x-oss-process=style/huayang'}}" mode="aspectFill"></image>
            <view class="title limit-two-line">{{item.title}}</view>
            <view class="info">
                <view class="info-wrap">
                    <view class="price-wrap">
                        <text>¥</text><text class="price">{{item.price}}</text>
                    </view>
                    <view class="discount-price-wrap">
                        <text class="discount-price">¥{{item.discount_price}}</text>
                        <image class="tag" src="https://huayang-img.oss-cn-shanghai.aliyuncs.com/1618455791dTGykq.jpg" mode="aspectFit"></image>
                    </view>
                </view>
                <view class="no">{{item.buy_count}}人已购</view>
            </view>
        </view>
    </view>

    <!-- 直播 -->
    <liveLayout wx:if="{{liveList.length > 0}}" class="limit-two-line" liveList="{{liveList}}" bind:openUserAuth="openUserAuth" />

    <!-- 大赛&活动 -->
    <view class="other-activity" wx:if="{{showModelBanner}}">
        <!-- 大赛 -->
        <view>
            <view class="competition-title">大赛</view>
            <view class="competition-list">
                <view class="competition-item" bindtap="toModelCompetition" data-item='{{item}}' wx:for="{{competitionBannerList}}" wx:key="index">
                    <image mode="aspectFill" src="{{item.pic_url}}"></image>
                    <view class="competition-item-title">{{item.title}}</view>
                </view>
            </view>
        </view>
    </view>

    <!-- 金刚位 -->
    <view class="fixed-site-module">
        <view class="fixed-site-list" id='fixed-site-list'>
            <view class="fixed-site-item" bindtap="fixedSiteItemTap" data-item="{{item}}" wx:for="{{fixedSiteList}}" wx:key='index'>
                <image src="{{item.icon}}"></image>
                <text>{{item.title}}</text>
            </view>
        </view>
    </view>

    <!-- 全局消息弹窗 -->
    <view class="information" catchtouchmove="onCatchtouchmove" wx:if="{{didShowInformation}}">
        <view class="information-mask {{showInformationPopAnime ? 'animation' : ''}}"></view>
        <block wx:if="{{popData.type === 'new_kecheng'}}">
            <view class="information-content {{showInformationPopAnime ? 'animation' : ''}}">
                <view class="information-pop-title">{{popData.popTitle}}</view>
                <view class="information-pop-info">
                    <image class="information-teacher-avatar" mode="aspectFit" src="{{popData.avatar}}"></image>
                    <view class="information-course-info">
                        <text class="information-course-name limit-one-line">{{popData.title}}</text>
                        <text class="information-course-desc limit-two-line">{{popData.desc}}</text>
                        <text class="information-course-teacher-info limit-one-line">{{popData.name}}</text>
                    </view>
                </view>
                <view class="information-pop-btn" bindtap="onInformationPopTap">立即查看</view>
                <image class="information-pop-close" bindtap="closeInformationPop" mode="aspectFit" src="https://huayang-img.oss-cn-shanghai.aliyuncs.com/1617938508Usopwi.jpg"></image>
                <view class="information-pop-clock">
                    <view class="information-pop-clock-item {{showInformationPopAnime ? 'animation' : ''}}"></view>
                </view>
            </view>
        </block>
        <block wx:if="{{popData.type === 'normal'}}">
            <view class="information-pop-picture-wrap" style="top: calc(50vh - 300rpx / {{popData.pictureRatio}});">
                <image class="information-pop-picture {{showInformationPopAnime ? 'animation' : ''}}" bindtap="jumpToLink" src="{{popData.picture}}" mode="widthFix"></image>
                <image class="information-pop-close" bindtap="closeInformationPop" mode="aspectFit" src="https://huayang-img.oss-cn-shanghai.aliyuncs.com/1617938508Usopwi.jpg"></image>
            </view>
        </block>
    </view>

    <!-- 授权弹窗 -->
    <authModule show="{{didShowAuth}}" bind:authCancelEvent="authCancelEvent" bind:authCompleteEvent="authCompleteEvent">
    </authModule>

    <!-- 客服弹窗 -->
    <contact show="{{didShowContact}}" isRootPage="{{true}}" sessionFrom="sf_study_guide" bind:closeContactModal="onCloseContactModal" />

    <!-- 未加入花样大学用户，不可参加校友活动 -->
    <fluentLearnModal show="{{didShowFluentLearnModal}}" message="您还未加入花样老年大学" confirmText="立即加入" bind:close="onFluentLearnCloseTap" bind:confirm="onFluentLearnTap" />

    <!-- 全局遮罩层 -->
    <view class="global-cover" wx:if="{{needShowGoodMorningPopup||showGoodMorningNoticePopup}}" bindtap="closeAllPopup" catchtouchmove="stopMove">
    </view>
</view>
